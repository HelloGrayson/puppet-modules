@version: 3.0
#Default configuration file for syslog-ng.
#
# For a description of syslog-ng configuration file directives, please read
# the syslog-ng Administrator's guide at:
#
# http://www.balabit.com/dl/html/syslog-ng-admin-guide_en.html/bk01-toc.html
#

options {
};

######
# sources
source s_local {
# message generated by Syslog-NG
internal();
# standard Linux log source (this is the default place for the syslog()
# function to send logs to)
unix-stream("/dev/log");
# messages from the kernel
file("/proc/kmsg" program_override("kernel: "));

<% if has_variable?("syslogConfigSources") then %>
    <% syslogConfigSources.each do |source| -%>
        <%= source["type"] %>("<%= source["path"] %>" follow_freq(<%= source["follow_freq"] %>) flags(<%= source["flags"] %>));
    <% end -%>
<% end %>

};


######
# destinations
destination d_messages { file("/var/log/messages"); };

<% if has_variable?("syslogConfigDestinations") then %>
    <% syslogConfigDestinations.each do |destination| -%>
        destination <%= destination["name"] %> { tcp("<%= destination["url"] %>" port(<%= destination["port"] %>)); };
    <% end -%>
<% end %>

log {
source(s_local);

<% if has_variable?("syslogConfigLog") then %>
    <% syslogConfigLog.each do |log| -%>
        <%= log["type"] %>(<%= log["value"] %>);
    <% end -%>
<% else %>
    destination(d_messages);
<% end %>

};

